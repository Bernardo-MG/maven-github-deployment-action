name: 'Signed artifact deployment'
description: 'Sign and deploy Maven artifacts'
author: 'Bernardo Martï¿½nez Garrido'
branding:
  icon: 'archive'
  color: 'green'
inputs:
  token:
    description: 'Github security token'
    required: true
  repository:
    description: 'Maven repository (distribution management) for deploying the artifacts'
    default: ossrh
    required: false
  profile:
    description: 'Maven profile for deployment'
    default: deployment-ossrh
    required: false
  jdk:
    description: 'JDK version to use'
    default: '11'
    required: false
runs:
    using: 'composite'
    steps:
    - name: Check-out
      uses: actions/checkout@v4
      with:
        persist-credentials: false
    - name: Set up JDK ${{ inputs.jdk }}
      uses: actions/setup-java@v4
      with:
        java-version: ${{ inputs.jdk }}
        distribution: 'temurin'
        server-id: ${{ inputs.repository }}
        cache: 'maven'
    - name: Package
      run: mvn clean package -B -P ${{ inputs.profile }} -DskipTests
      shell: bash
    - name: Deploy
      run: mvn deploy -B -P ${{ inputs.profile }} -DskipTests
      shell: bash
      env:
        GITHUB_TOKEN: ${{ inputs.token }}